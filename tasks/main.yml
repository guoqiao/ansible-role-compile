---

- name: gather facts
  tags: always
  setup:

- name: update environment
  become: yes
  copy:
    content: |
      PATH="/usr/local/sbin:/usr/local/bin:/usr/sbin:/usr/bin:/sbin:/bin"
      CC="ccache gcc"
    dest: /etc/environment
    force: yes

- name: ensure locales installed
  become: yes
  package:
    name: locales

- name: update locale
  become: yes
  copy:
    content: |
      LC_ALL=en_US.UTF-8
    dest: /etc/default/locale
    force: yes

- name: ensure locale
  become: yes
  locale_gen:
    name: en_US.UTF-8
    state: present

- name: check pkg
  command: which {{pkg_name}}
  failed_when: false
  changed_when: false
  register: which

- name: include tasks if forced or not available
  include_tasks: _main.yml
  when: 'xbuild_force or which.rc != 0'
